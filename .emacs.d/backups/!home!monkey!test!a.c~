#include <stdio.h>
#include <string.h>
int replace(char *source, char *s1,char *s2, int flag);
int main()
{
	char source[200];
	char s1[20];
	char s2[20];
	int flag,j,ans;
	scanf("%d",&flag);
	getchar();
	gets(source);
	gets(s1);
	gets(s2);
	ans = replace(source,s1,s2,flag);
	printf("%d\n",ans); 
	puts(source);
	return 0;
}

void abc()
{
	
}
int replace(char *source, char *s1,char *s2, int flag)
{
	abc();
	char *pch;
	char *p,*q;
	int i;
	char n,m,h;
	h = strlen(source);
	n = strlen(s2);
	m = strlen(s1);
	q = source - m;
	p = source + 200;
	strcpy(p ,source);
	if(flag == 0)
	{
		for(i = 0;i < h;i++)
		{
			source[i] = tolower(source[i]);
			s1[i] = tolower(s1[i]);
			s2[i] = tolower(s2[i]);
		}
		source[h] = '\0';
		s1[m] = '\0';
		s2[n] = '\0';
	}
	for(i = 1;i < 200;i++)
	{
		pch = strstr(q + m,s1);
		if(pch == NULL)
		{
			break;
		}
		q = pch;
		strcpy ((q + 200 +((i - 1)*(n - m))),s2);
		strcpy((q + 200 + ((i - 1)*(n - m)) + n),(q + m)); 
	}
	strcpy(source ,p);
	return (i - 1);
}
